import{u as e,a as l}from"./chunk-42efbe09.js";import{s}from"./chunk-fef0cdc6.js";import{r as t,u as a,w as o}from"./chunk-8a748b86.js";import{r as n}from"./chunk-05f6b65c.js";import{_ as i}from"./chunk-7b79636b.js";import{a8 as r,r as c,o as p,aN as m,Y as d,Z as u,b8 as b,u as h,a5 as k,F as g}from"./chunk-6addeafd.js";import"./chunk-ae148721.js";import"./chunk-e0a53dd1.js";import"./chunk-65a2ac68.js";import"./chunk-79c60fa1.js";import"./chunk-38e6902a.js";import"./chunk-5a8af153.js";import"./chunk-1974f2ff.js";import"./chunk-07814c5c.js";import"./chunk-c7a1205e.js";import"./chunk-3fae03ad.js";import"./chunk-4c5d5523.js";import"./chunk-66446df1.js";import"./chunk-6e0e2973.js";import"./chunk-54735b0f.js";import"./chunk-ca6057e9.js";import"./chunk-70d140bd.js";const f={class:"modal-box"},j=u("h3",{class:"text-lg font-bold"},"提示!",-1),x=u("p",{class:"py-4"},"該操作會清空人員中獎信息，是否繼續？",-1),y={class:"modal-action"},_={method:"dialog",class:"flex gap-3"},v={class:"modal-box"},A=u("h3",{class:"text-lg font-bold"},"提示!",-1),C=u("p",{class:"py-4"},"該操作會刪除所有人員數據，是否繼續？",-1),N={class:"modal-action"},P={method:"dialog",class:"flex gap-3"},w={class:"min-w-1000px"},z=u("h2",null,"人員管理",-1),S={class:"flex gap-3"},L=u("div",{class:"tooltip tooltip-bottom","data-tip":"下載文件後，請在excel中填寫數據，並保存為xlsx格式"},[u("a",{class:"no-underline btn btn-secondary btn-sm",download:"PeopleList.xlsx",target:"_blank",href:"../../PeopleList.xlsx"},"下載模板")],-1),W={class:""},D={for:"explore"},T={class:"tooltip tooltip-bottom","data-tip":"上傳修改好的excel文"},J=u("span",{class:"btn btn-primary btn-sm"},"導入人員數據",-1),O=u("span",null,"中獎人數：",-1),M=u("span",null," / ",-1),q=r({__name:"PersonAll",setup(r){const q=e().personConfig,{getAllPersonList:F,getAlreadyPersonList:I}=s(q),K=c(),V=c(),Y=async e=>{let s=await n(e.target.files[0]),o=t(s,{type:"binary",cellDates:!0}),i=o.Sheets[o.SheetNames[0]];const r=a.sheet_to_json(i),c=l(r);q.resetPerson(),q.addNotPersonList(c)},Z=()=>{let e=JSON.parse(JSON.stringify(F.value));for(let s=0;s<e.length;s++)delete e[s].x,delete e[s].y,delete e[s].id,delete e[s].createTime,delete e[s].updateTime,delete e[s].prizeId,e[s].isWin?e[s].isWin="是":e[s].isWin="否",e[s].prizeTime=e[s].prizeTime.join(","),e[s].prizeName=e[s].prizeName.join(",");let l=JSON.stringify(e);if(l=l.replaceAll(/uid/g,"編號").replaceAll(/isWin/g,"是否中獎").replaceAll(/introducer/g,"推薦人").replaceAll(/name/g,"姓名").replaceAll(/prizeName/g,"獲獎").replaceAll(/prizeTime/g,"獲獎時間"),e=JSON.parse(l),e.length>0){const l=a.json_to_sheet(e),s=a.book_new();a.book_append_sheet(s,l,"Sheet1"),o(s,"data.xlsx")}},B=()=>{q.resetAlreadyPerson()},E=()=>{q.deleteAllPerson()},G=[{label:"編號",props:"uid"},{label:"姓名",props:"name"},{label:"推薦人",props:"introducer"},{label:"是否已中獎",props:"isWin",formatValue:e=>e.isWin?"是":"否"},{label:"操作",actions:[{label:"删除",type:"btn-error",onClick:e=>{(e=>{q.deletePerson(e)})(e)}}]}];return p((()=>{})),(e,l)=>(m(),d(g,null,[u("dialog",{id:"my_modal_1",ref_key:"resetDataDialog",ref:K,class:"border-none modal"},[u("div",f,[j,x,u("div",y,[u("form",_,[u("button",{class:"btn",onClick:l[0]||(l[0]=e=>K.value.close())},"取消"),u("button",{class:"btn",onClick:B},"確定")])])])],512),u("dialog",{id:"my_modal_1",ref_key:"delAllDataDialog",ref:V,class:"border-none modal"},[u("div",v,[A,C,u("div",N,[u("form",P,[u("button",{class:"btn",onClick:l[1]||(l[1]=e=>V.value.close())},"取消"),u("button",{class:"btn",onClick:E},"确定")])])])],512),u("div",w,[z,u("div",S,[u("button",{class:"btn btn-error btn-sm",onClick:l[2]||(l[2]=e=>V.value.showModal())},"全部删除"),L,u("div",W,[u("label",D,[u("div",T,[u("input",{type:"file",class:"",id:"explore",style:{display:"none"},onChange:Y,accept:".xlsx,.xls"},null,32),J])])]),u("button",{class:"btn btn-error btn-sm",onClick:l[3]||(l[3]=e=>K.value.showModal())},"重置人員數據"),u("button",{class:"btn btn-accent btn-sm",onClick:Z},"導出結果"),u("div",null,[O,u("span",null,b(h(I).length),1),M,u("span",null,b(h(F).length),1)])]),k(i,{tableColumns:G,data:h(F)},null,8,["data"])])],64))}});export{q as default};
